@model SiteBuilder.Models.Page

@{
    ViewBag.Title = "CreatePage";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<h2>CreatePage</h2>

<h5 class="text-center">Pages this site</h5>
@foreach (var Page in ViewBag.Pages)
{
    <p class="text-center">@Page.Name</p>
}

<div class="container">
    <div class="row">
        <div class="col-md-4 col-md-offset-4">
            @using (Html.BeginForm())
            {
                @Html.ValidationSummary()
                @Html.HiddenFor(x => x.SiteId, new { Value = ViewBag.SiteId})
                <div class="form-group">
                    <label>Name</label>
                    @Html.TextBoxFor(x => x.Name, new { @class = "form-control", type = "text" })
                </div>
                <button type="submit" class="btn btn-default">Submit</button>
            }
        </div>
    </div>
</div>

<h4 class="text-center">Add content:</h4>

<div id="layout"></div>

<h4 class="text-center" id="droppable">Type layout:</h4>
<button id="template1" onclick="loadTemplate(this)">1</button>
<button id="template2" onclick="loadTemplate(this)">1</button>
<button id="template3" onclick="loadTemplate(this)">1</button>


<a href="/SiteBuilder/Show/@ViewBag.UserId/@ViewBag.SiteId/">View site</a>


@section Scripts
    {

@Scripts.Render("~/bundles/jquery-ui")

<script>
    $(function () {
        $("#draggable").draggable();
        $("#droppable").droppable({
            drop: function (event, ui) {
                $(this)
                  .find("p")
                    .html("Dropped!");
            }
        });
    });

    function loadTemplate(e) {
        $.ajax({
            type: 'POST',
            url: "/SiteBuilder/LoadTemplate",
            data: { nameTemplate: e.id },
            success: function (data) {
                $("#layout").empty();
                $("#layout").html(data);
                $("#layout").find("div").attr('id', 'droppable');
            }
        });
    }
</script>
}